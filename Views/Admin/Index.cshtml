

@{
    ViewBag.Title = "Ana Sayfa";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<div class="container-fluid px-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 mb-0"><i class="fas fa-home me-2 text-dark"></i>Ana Sayfa</h1>
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0 bg-transparent p-0">
                <li class="breadcrumb-item"><a href="/Admin/Index"><i class="fas fa-home"></i></a></li>
                <li class="breadcrumb-item active" aria-current="page">Ana Sayfa</li>
            </ol>
        </nav>
    </div>

    <!-- Günlük, Toplam Gelir ve Gider Kartları -->
    <div class="row mt-4 g-3 mb-5">
        <div class="col-xl-4 col-md-6">
            <div class="card bg-light text-dark h-100">
                <div class="card-body">
                    <strong> Günün Toplam Satış Tutarı: (Nakit+Kart+Veresiye)</strong><br />
                    <strong>@String.Format("{0:C}", ViewBag.GununToplamSatis ?? 0)</strong>
                    <hr />
                    <span class="fw-bold">Günün Gelirleri:</span><br />
                    <strong class="text-success">@String.Format("{0:C}", ViewBag.GununToplamGelir ?? 0)</strong><br />
                    <span class="fw-bold">Günün Giderleri:</span><br />
                    <strong class="text-danger">Kart: @String.Format("{0:C}", ViewBag.gununKartGiderleri ?? 0)</strong> <br />
                    <strong class="text-danger">Nakit: @String.Format("{0:C}", ViewBag.gununNakitGiderleri ?? 0)</strong><br />
                    <strong class="text-danger">Kasa: @String.Format("{0:C}", ViewBag.gununKasaGider ?? 0)</strong><br />

                    <hr />
                    <!-- Butonlar -->
                    <a href="@Url.Action("GelirGider", "GelirGider")" class="btn btn-primary me-2">
                        <i class="bi bi-cash-stack"></i> Gelir Gider
                    </a>
                    <a href="@Url.Action("RaporPaneli", "GelirGider")" class="btn btn-secondary">
                        <i class="bi bi-bar-chart-line"></i> Raporlar
                    </a>
                </div>
            </div>
        </div>

        <div class="col-xl-4 col-md-6">

            <div class="card mb-4" style="max-width: 400px; font-size: 0.9rem;">
                <div class="card-header bg-dark text-white py-2 px-3" style="font-size: 1rem;">
                    <strong>En Çok Satılan 5 Ürün</strong>
                </div>
                <ul class="list-group list-group-flush">
                    @if (ViewBag.EnCokSatilanUrunler != null)
                    {
                        foreach (var urun in (List<KeyValuePair<string, int>>)ViewBag.EnCokSatilanUrunler)
                        {
                            <li class="list-group-item d-flex justify-content-between align-items-center py-1 px-2">
                                @urun.Key
                                <span class="badge bg-primary rounded-pill">@urun.Value adet</span>
                            </li>
                        }
                    }
                    else
                    {
                        <li class="list-group-item py-1 px-2">Veri bulunamadı.</li>
                    }
                </ul>
            </div>
        </div>

        <!-- Sürüm Notları / Yenilikler Alanı -->
        <div class="row mb-5 mt-5">
            <div class="col-xl-8">
                <div class="card border-dark">
                    <div class="card-header bg-dark text-white">
                        <strong><i class="bi bi-stars"></i> Yenilikler & Güncellemeler</strong>
                    </div>
                    <div class="card-body" style="max-height: 300px; overflow-y: auto;">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">
                                <strong>v.1.0</strong> - Tarih: 2025-05-19 | Projenin ilk sürümü yayınlandı.
                            </li>
                            <li class="list-group-item">
                                <strong>v.1.1</strong> - Tarih: 2025-05-19 | Geliştirme hataları giderildi.
                            </li>
                            <li class="list-group-item">
                                <strong>v.1.2</strong> - Tarih: 2025-05-20 | Artık yeni ürün eklerken, barkod okuturken kamera kullanılabilecek.
                            </li>
                            <li class="list-group-item">
                                <strong>v.1.3</strong> - Tarih: 2025-05-20 | Artık yeni ürün eklerken, barkod okuturken arka kamera kullanılabilecek. (mobil için)
                            </li>
                            <li class="list-group-item">
                                <strong>v.1.4</strong> - Tarih: 2025-05-20 | Artık ürün ekleyince var olan bir barkod var ise ürünü getiriyor ve güncellemeni sağlıyor. Artık admin ekranında ki ürünler tamamen silinebilir hale geldi. Satış ekranında barkodsuz ürün girilince ürün bulunamadı diyor ve yeni ürün ekleme ekranına barkod ile yönlendiriyor.
                            </li>
                            <li class="list-group-item">
                                <strong>v.1.5</strong> - Tarih: 2025-05-20 | Admin rapor sayfası ve satış sayfasında iyileştirmeler.
                            </li>
                            <li class="list-group-item">
                                <strong>v.1.6</strong> - Tarih: 2025-05-21 | Makbuz düzenlendi. Rapor paneli istatistikleri güncellendi. Satış sayfasında barkod alanına ocuslar tamamlandı. Gelir gider sayfasında düzenlemeler.
                            </li>
                            <li class="list-group-item">
                                <strong>v.1.7</strong> - Geliştirme hataları giderildi
                            </li>
                            <li class="list-group-item">
                                <strong>v.1.8</strong> - Tarih: 2025-05-21 | Satış işlemleri sayfası eklendi. Artık ürün eklerken yarıda kalan bir işlem veya iptal edilmek istenen bir işlem olduğunda form sıfırlanıyor. müşteri borç veya alacak girerken küsürat girilebilecek. Satış ekranında focus olayı düzeltildi. Rapor ekranı ilk açıldığında günün verileri otomatik geliyor.
                            </li>
                            <li class="list-group-item">
                                <strong>v.1.9</strong> - Tarih: 2025-05-22 | barkod alanı hızlandırma. Toptancı günleri geldiğinde mail atma özelliği. Admin ekranına toptanci sayfası eklendi. Gelir gider kaldırma. Satış sayfası iyileştirmeleri. Admin ana sayfasına yeni istatistikler eklendi.
                            </li>
                            <li class="list-group-item">
                                <strong>v.2.0</strong> - Tarih: 2025-05-23 | Geliştirme hataları giderildi. Toptancı günlerinde gönderilen mail adresi değiştirildi. Satış sonrası geçen süre 1,1 sn olarak ayarlandı. Gereksiz dosyalar kaldırıldı. Hata sayfası düzenlendi. Admin ana sayfasına versiyonlar eklendi.
                            </li>

                            <li class="list-group-item ">
                                <strong>v.2.1</strong> - Tarih: 2025-05-23 | Müşteri borç ödendiğinde Nakit ve Kart şeklinde ödeme tipi seçilecek ve günlük işlemlere yansıyacak.
                            </li>
                            <li class="list-group-item text">
                                <strong>v.2.2</strong> - Tarih: 2025-05-23 | admin ekranı responsive düzenlemeler.  admin rapor sayfası güncellendi artık mobilde daha iyi gözüküyor. Gelir gider sayfası hatası giderildi. admin index responsive olmama hatası giderildi
                            </li>
                            <li class="list-group-item text-danger">
                                <strong>v.2.3</strong> - Tarih: 2025-05-24 | satış yaparken ürün listesine eklenen ürünler en üste geliyor. İşlem beklet butonu artık aktif

                            </li>


                            <li class="list-group-item text-muted text-center">Yeni sürümde eklenenler burada listelenecek.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    </div>





    @*<h2 class="mb-4">Tüm Zaman İstatistikleri</h2>

    <div style="display: flex; gap: 20px; max-width: 800px; max-height: 300px;">
        <canvas id="GelirGiderChart" style="flex: 1; max-width: 400px; height: 300px;"></canvas>
        <canvas id="OdemeTurleriChart" style="flex: 1; max-width: 400px; height: 300px;"></canvas>
    </div>


    <script>
    // Gelir-Gider Grafik
    var gelirGiderCtx = document.getElementById('GelirGiderChart').getContext('2d');
    var gelirGiderChart = new Chart(gelirGiderCtx, {
        type: 'pie',
        data: {
            labels: ['Gelir', 'Gider'],
            datasets: [{
                label: 'Gelir ve Gider',
                data: [
                    @Html.Raw(ViewBag.ToplamGelir ?? 0),
                    @Html.Raw(ViewBag.ToplamGider ?? 0)
                ],
                backgroundColor: [
                    'rgba(54, 162, 235, 0.7)',  // Mavi - Gelir
                    'rgba(255, 99, 132, 0.7)'   // Kırmızı - Gider
                ],
                borderColor: [
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 99, 132, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        boxWidth: 12,
                        font: { size: 12 }
                    }
                },
                title: {
                    display: true,
                    text: 'Tüm Zamanların Gelir Gider Tablosu',
                    font: { size: 14 }
                }
            }
        }
    });

    // Ödeme Türleri Grafik
    var odemeTurleriCtx = document.getElementById('OdemeTurleriChart').getContext('2d');
    var odemeTurleriChart = new Chart(odemeTurleriCtx, {
        type: 'pie',
        data: {
            labels: ['Nakit', 'Kart', 'Veresiye'],
            datasets: [{
                label: 'Ödemeler Toplamı',
                data: [
                    @Html.Raw(ViewBag.NakitToplam ?? 0),
                    @Html.Raw(ViewBag.KartToplam ?? 0),
                    @Html.Raw(ViewBag.VeresiyeToplam ?? 0)
                ],
                backgroundColor: [
                    'rgba(54, 162, 235, 0.7)',  // Mavi
                    'rgba(255, 206, 86, 0.7)',  // Sarı
                    'rgba(75, 192, 192, 0.7)'   // Turkuaz
                ],
                borderColor: [
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        boxWidth: 12,
                        font: { size: 12 }
                    }
                },
                title: {
                    display: true,
                    text: 'Tüm Zamanların Ödeme Türlerine Göre Kazancı',
                    font: { size: 14 }
                }
            }
        }
    });
    </script>*@

    <!-- Ödeme Bilgi Kartları -->
    <div class="row g-3 mt-4">
        <div class="col-xl-3 col-md-6">
            <div class="card bg-primary text-white h-100">
                <div class="card-body">
                    <strong>Nakit Ödemeler Toplamı</strong>
                    <h3 class="mt-2">@String.Format("{0:C}", ViewBag.NakitToplam ?? 0)</h3>
                </div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                    <a class="small text-white stretched-link" href="/GelirGider/RaporPaneli">Detayları Gör</a>
                    <i class="fas fa-angle-right text-white"></i>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6">
            <div class="card bg-warning text-white h-100">
                <div class="card-body">
                    <strong>Kart Ödemeler Toplamı</strong>
                    <h3 class="mt-2">@String.Format("{0:C}", ViewBag.KartToplam ?? 0)</h3>
                </div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                    <a class="small text-white stretched-link" href="/GelirGider/RaporPaneli">Detayları Gör</a>
                    <i class="fas fa-angle-right text-white"></i>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6">
            <div class="card bg-success text-white h-100">
                <div class="card-body">
                    <strong>Veresiye Ödemeler Toplamı</strong>
                    <h3 class="mt-2">@String.Format("{0:C}", ViewBag.VeresiyeToplam ?? 0)</h3>
                </div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                    <a class="small text-white stretched-link" href="/GelirGider/RaporPaneli">Detayları Gör</a>
                    <i class="fas fa-angle-right text-white"></i>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6">
            <div class="card bg-danger text-white h-100">
                <div class="card-body">
                    <strong>En Çok Veresiye Alan Müşteri</strong>
                    <h5 class="mt-2">
                        @ViewBag.EnCokVeresiyeAlanMusteri <br />
                        Toplam: @String.Format("{0:C}", ViewBag.EnCokVeresiyeAlanMusteriBorcu ?? 0)
                    </h5>
                </div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                    <a class="small text-white stretched-link" href="/Musteri/MusteriGetir/@ViewBag.EnCokVeresiyeAlanMusteriID">Müşteri Detayları</a>
                    <i class="fas fa-angle-right text-white"></i>
                </div>
            </div>
        </div>
    </div>
</div>